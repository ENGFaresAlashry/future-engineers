<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Spring–Mass System</title>
<style>
body {
  background: radial-gradient(circle at top,#111,#000);
  color: white;
  font-family: Arial;
  text-align: center;
}
canvas {
  background:#050505;
  margin:20px auto;
  display:block;
  border-radius:12px;
  box-shadow:0 0 25px #00e5ff33;
}
button {
  padding:12px 28px;
  margin:10px;
  border:none;
  border-radius:25px;
  background:#00e5ff;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>

<h1 style="color:#00e5ff">Spring–Mass Oscillation</h1>

<button onclick="start()">Start</button>
<button onclick="stop()">Stop</button>

<canvas id="sim" width="900" height="300"></canvas>
<canvas id="posC" width="900" height="200"></canvas>
<canvas id="velC" width="900" height="200"></canvas>
<canvas id="engC" width="900" height="200"></canvas>

<script>
// ===== CONSTANTS =====
const m = 0.06;
const k = 8;
const L0 = 0.20;
const g = 9.8;
const dt = 0.02;

// ===== EQUILIBRIUM =====
const x_eq = L0 + (m*g)/k;

// ===== STATE =====
let x = 0.10;
let v = 0;
let run=false, timer;

// ===== DATA =====
let X=[], V=[], E=[];

// ===== CONTEXTS =====
const s=sim.getContext("2d");
const p=posC.getContext("2d");
const vctx=velC.getContext("2d");
const e=engC.getContext("2d");

// ===== DRAW SIM =====
function drawSim(){
  s.clearRect(0,0,900,300);
  s.fillStyle="white";
  s.fillRect(430,20,40,10);

  s.strokeStyle="yellow";
  s.lineWidth=4;
  s.beginPath();
  s.moveTo(450,30);
  s.lineTo(450,30+(x*700));
  s.stroke();

  s.fillStyle="red";
  s.beginPath();
  s.arc(450,30+x*700+18,18,0,Math.PI*2);
  s.fill();
}

// ===== GRAPH FUNCTION =====
function graph(ctx,title,ylabel,data,color,center=true){
  ctx.clearRect(0,0,900,200);
  const L=80, T=40, H=120, M=T+H/2;

  ctx.strokeStyle="#444";
  ctx.beginPath();
  ctx.moveTo(L,T); ctx.lineTo(L,T+H); ctx.lineTo(880,T+H);
  ctx.stroke();

  ctx.fillStyle="#00e5ff";
  ctx.font="16px Arial";
  ctx.fillText(title,L+10,25);

  ctx.fillStyle="#aaa";
  ctx.font="13px Arial";
  ctx.fillText(ylabel,10,60);
  ctx.fillText("Time (s)",820,185);

  let max=Math.max(...data.map(d=>Math.abs(d))) || 1;
  let scale=(H/2)/max*0.9;

  if(center){
    ctx.strokeStyle="#333";
    ctx.beginPath();
    ctx.moveTo(L,M); ctx.lineTo(880,M);
    ctx.stroke();
  }

  ctx.strokeStyle=color;
  ctx.lineWidth=2;
  ctx.beginPath();
  data.forEach((d,i)=>{
    let x=L+i*3;
    let y=center? M-d*scale : T+H-d*scale;
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  });
  ctx.stroke();
}

// ===== UPDATE =====
function step(){
  const F=-k*(x-L0)+m*g;
  const a=F/m;

  v+=a*dt;
  x+=v*dt;

  X.push(x-x_eq);
  V.push(v);
  E.push(0.5*m*v*v+0.5*k*(x-x_eq)**2);

  if(X.length>250){X.shift();V.shift();E.shift();}

  drawSim();
  graph(p,"Position vs Time","Displacement (m)",X,"#00e5ff");
  graph(vctx,"Velocity vs Time","Velocity (m/s)",V,"#ff3333");
  graph(e,"Total Energy vs Time","Energy (J)",E,"#00ff88",false);
}

// ===== CONTROL =====
function start(){ if(!run){run=true;timer=setInterval(step,20);} }
function stop(){ run=false; clearInterval(timer); }

drawSim();
</script>

</body>
</html>
